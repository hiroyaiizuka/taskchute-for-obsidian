# プロジェクト進捗比較機能

## 概要
プロジェクトノートの進捗を過去の類似プロジェクトと比較し、グラフで可視化する機能です。現在の進捗が順調か、遅いか、早いかを一目で判断でき、完了予測日も表示します。

## 必要なプラグイン
- **Dataview** - データ処理とコード実行
- **Obsidian Charts** - グラフ描画

## 使い方

### 1. プロジェクトノートの準備
プロジェクトノートに以下の構造でタスクリストを作成します：

```markdown
## タスク（次の一手）
- [x] 要件定義 ✅ 2025-01-01T14:30
- [x] 設計 ✅ 2025-01-05T16:00
- [ ] 実装
- [ ] テスト
- [ ] リリース
```

### 2. Dataviewjsコードの埋め込み
プロジェクトノートの適切な場所（通常は概要の後）に、以下のようにDataviewjsコードブロックを追加します：

````markdown
## プロジェクト進捗比較

```dataviewjs
// ここにdataviewjs-template.jsの内容をコピー
```
````

実際のコードは `dataviewjs-template.js` ファイルからコピーしてください。

### 3. 実行結果
コードブロックを追加すると、自動的に以下が表示されます：

1. **進捗比較グラフ**（棒グラフ）
   - 現在のプロジェクト：赤色（#FF6B6B）
   - 類似プロジェクト：灰色（#888888）
   - X軸：経過日数、Y軸：完了率（%）

2. **完了予測**
   - 予測完了日
   - 残り日数
   - 現在のペース（1日あたりの進捗率）

## 類似プロジェクトの指定方法

Dataviewのメタデータ記法を使って、類似プロジェクトを明示的に指定します：

```markdown
similar to:: [[Project - 前回のプロジェクト]]
similar to:: [[Project - 参考プロジェクト]]
```

- `similar to` で指定されたwikilinkが類似プロジェクトとして使用されます
- 複数指定可能（各行に1つずつ記載）
- 類似プロジェクトの指定がない場合、比較グラフは現在のプロジェクトのみ表示されます

## グラフの見方

### 凡例のチェックボックス
Obsidian Chartsの標準機能により、凡例のプロジェクト名の横にあるチェックボックスで表示/非表示を切り替えられます。

### 進捗率の計算
- **現在のプロジェクト**：完了タスク数 ÷ 類似プロジェクトの平均タスク数
- **類似プロジェクト**：完了タスク数 ÷ 自分のタスク総数

### 進捗ステータス
- **右上がり**：順調に進捗
- **フラット**：進捗が停滞
- **他プロジェクトより上**：早いペース
- **他プロジェクトより下**：遅いペース

### グラフの期間
- **現在のプロジェクト**：最後のタスク完了日まで
- **類似プロジェクト**：各プロジェクトの最後のタスク完了日まで

## トラブルシューティング

### エラー：「Dataviewプラグインがインストールされていません」
→ コミュニティプラグインからDataviewをインストールしてください。

### エラー：「Obsidian Chartsプラグインがインストールされていません」
→ コミュニティプラグインからObsidian Chartsをインストールしてください。

### タスクが見つかりません
→ 「## タスク（次の一手）」セクションが存在することを確認してください。
→ チェックリスト形式（`- [ ]` または `- [x]`）でタスクを記述してください。

### グラフが表示されない
→ Obsidian Chartsが有効になっているか確認してください。
→ コンソールログでエラーを確認してください（Ctrl/Cmd + Shift + I）。

### 類似プロジェクトが表示されない
→ `similar to::` でプロジェクトを明示的に指定してください。
→ wikilinkが正しく記述されているか確認してください。

## カスタマイズ

### 色の変更
コード内の以下の部分を編集して色を変更できます：
```javascript
const color = project.isCurrent ? '#FF6B6B' : '#888888';
```

### 予測の重み
現在のペースと類似プロジェクトの重みは以下で調整できます：
```javascript
const weight = 0.7; // 現在のペースを70%重視
```

## 注意事項
- プロジェクト開始日は最初のタスク完了日から自動取得されます（完了タスクがない場合はファイル作成日）
- Day0は最初のタスク完了日で、0%からスタートします
- 完了日時から実際の進捗カーブを計算します
- 現在のプロジェクトの進捗率は、類似プロジェクトの平均タスク数を基準に計算されます
- 最大1年間のデータを表示します（365日以降は切り捨て）